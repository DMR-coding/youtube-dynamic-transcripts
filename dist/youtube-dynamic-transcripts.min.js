!function(){"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var n;t.g.importScripts&&(n=t.g.location+"");var e=t.g.document;if(!n&&e&&(e.currentScript&&(n=e.currentScript.src),!n)){var o=e.getElementsByTagName("script");o.length&&(n=o[o.length-1].src)}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=n}(),function(){function t(t,n,e){var o=t.className.indexOf(n)>=0,i=null==e?!o:e;o&&i||!o&&!i||(i?t.className+=" ".concat(n):t.className=function(t,n,e){return t.split(" ").filter((function(t){return t!==n})).join(" ")}(t.className,n))}function n(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var e=function t(e,o,i){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,"domElement",void 0),n(this,"start",void 0),n(this,"end",void 0),this.end=o,this.start=e,this.domElement=document.createElement("a"),this.domElement.textContent=i,this.domElement.className="caption"};function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var i="Open Transcript",r=function n(r,a,c){var s=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),o(this,"player",void 0),o(this,"captionTimeout",void 0),o(this,"currentCaption",void 0),o(this,"captions",[]),o(this,"videoID",void 0),o(this,"captionBox",void 0),o(this,"toggler",void 0),o(this,"container",void 0),o(this,"loadCaptions",(function(t){(function(t){return new Promise((function(n,e){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="document",o.onload=function(){n(o.response)},o.onerror=function(){e(o.status)},o.send()}))})(t).then(s.captionsLoaded).catch(s.captionsFailed),s.captionBox.textContent="Loading transcript..."})),o(this,"captionsLoaded",(function(t){var n=t.getElementsByTagName("text");s.captionBox.textContent="";for(var o=function(t){var o=+n[t].getAttribute("start"),i=+n[t].getAttribute("dur")+o,r=new e(o,i,n[t].textContent);r.domElement.addEventListener("click",(function(){s.seekToIndex(t)})),s.captions.push(r),s.captionBox.append(r.domElement),s.captionBox.scrollTo(0,0)},i=0;i<n.length;i+=1)o(i)})),o(this,"seekToIndex",(function(t){var n=s.captions[t];s.player.seekTo(n.start,!0)})),o(this,"captionsFailed",(function(){s.captionBox.textContent="⚠️ Could not load transcript."})),o(this,"onStateChange",(function(t){console.log(t),t.data===YT.PlayerState.PLAYING?s.started():s.stopped()})),o(this,"started",(function(){s.highlightCurrentCaption()})),o(this,"stopped",(function(){s.removeCurrentHighlight(),s.clearTimeout()})),o(this,"highlightCurrentCaption",(function(){s.removeCurrentHighlight();var n,e,o,i=s.player.getCurrentTime();s.currentCaption=s.captions.find((function(t){return t.start<=i&&t.end>i})),s.currentCaption&&(t(s.currentCaption.domElement,"highlight",!0),e=(n=s.currentCaption.domElement).getBoundingClientRect(),o=n.parentElement.getBoundingClientRect(),e.top>=o.top&&e.bottom<=o.bottom||setTimeout((function(){s.currentCaption.domElement.scrollIntoView()}),0)),s.waitForNextCaption()})),o(this,"waitForNextCaption",(function(){s.clearTimeout();var t=s.player.getCurrentTime(),n=s.captions.find((function(n){return n.start>t}));if(n){var e=n.start-t;s.captionTimeout=setTimeout(s.highlightCurrentCaption,1e3*e)}})),o(this,"clearTimeout",(function(){s.captionTimeout&&clearTimeout(s.captionTimeout),s.captionTimeout=null})),o(this,"appendContainer",(function(){s.container=document.createElement("div"),s.container.className="ytdt",s.toggler=document.createElement("button"),s.toggler.className="toggle closed",s.toggler.addEventListener("click",s.toggle),s.toggler.textContent=i,s.container.append(s.toggler),s.captionBox=document.createElement("div"),s.captionBox.className="captions closed",s.container.append(s.captionBox),document.getElementById(s.videoID).after(s.container)})),o(this,"toggle",(function(){t(s.toggler,"closed"),t(s.toggler,"open"),t(s.captionBox,"closed"),t(s.captionBox,"open"),s.toggler.className.indexOf("closed")>-1?s.toggler.textContent=i:s.toggler.textContent="Close Transcript"})),o(this,"removeCurrentHighlight",(function(){s.currentCaption&&(t(s.currentCaption.domElement,"highlight",!1),s.currentCaption=null)})),this.videoID=r;var l="https://video.google.com/timedtext?v="+r;a&&(l+="&lang=".concat(a)),c&&(l+="&name=".concat(c)),this.appendContainer(),this.loadCaptions(l),this.player=new YT.Player(r,{videoId:r,events:{onStateChange:this.onStateChange}})};function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var c=[],s=[],l={Transcript:r,init:function(t,n,e){window.YT.Player?s.push(new r(t,n,e)):c.push([t,n,e])}},u=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){u&&u();var t,n=function(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return a(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return c=t.done,t},e:function(t){s=!0,r=t},f:function(){try{c||null==e.return||e.return()}finally{if(s)throw r}}}}(c);try{for(n.s();!(t=n.n()).done;){var e=t.value;l.init.apply(this,e)}}catch(t){n.e(t)}finally{n.f()}},window.ytdt?console.warn("Namespace already exists; not registering youtube-dynamic-transcripts"):window.ytdt=l}(),t.p}();
//# sourceMappingURL=youtube-dynamic-transcripts.min.js.map