!function(){"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var o=n.getElementsByTagName("script");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),function(){function t(t,e,n){var o=t.className.indexOf(e)>=0,i=null==n?!o:n;o&&i||!o&&!i||(i?t.className+=" ".concat(e):t.className=function(t,e,n){return t.split(" ").filter((function(t){return t!==e})).join(" ")}(t.className,e))}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var n=function t(n,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e(this,"domElement",void 0),e(this,"start",void 0),e(this,"end",void 0),this.end=o,this.start=n,this.domElement=document.createElement("a"),this.domElement.innerHTML=i,this.domElement.className="caption"};function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i="Open Transcript",r=function e(r,a,c,s){var l=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"player",void 0),o(this,"playerElement",void 0),o(this,"captionTimeout",void 0),o(this,"currentCaption",void 0),o(this,"captions",[]),o(this,"videoID",void 0),o(this,"captionBox",void 0),o(this,"toggler",void 0),o(this,"container",void 0),o(this,"loadCaptions",(function(t){(function(t){return new Promise((function(e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="document",o.onload=function(){e(o.response)},o.onerror=function(){n(o.status)},o.send()}))})(t).then(l.captionsLoaded).catch(l.captionsFailed),l.captionBox.textContent="Loading transcript..."})),o(this,"captionsLoaded",(function(t){var e=t.getElementsByTagName("text");l.captionBox.textContent="";for(var o=function(t){var o=+e[t].getAttribute("start"),i=+e[t].getAttribute("dur")+o,r=new n(o,i,e[t].textContent);r.domElement.addEventListener("click",(function(){l.seekToIndex(t)})),l.captions.push(r),l.captionBox.append(r.domElement),l.captionBox.scrollTop=0},i=0;i<e.length;i+=1)o(i)})),o(this,"seekToIndex",(function(t){var e=l.captions[t];l.player.seekTo(e.start,!0)})),o(this,"captionsFailed",(function(){l.captionBox.textContent="⚠️ Could not load transcript."})),o(this,"onStateChange",(function(t){console.log(t),t.data===YT.PlayerState.PLAYING?l.started():l.stopped()})),o(this,"started",(function(){l.highlightCurrentCaption()})),o(this,"stopped",(function(){l.removeCurrentHighlight(),l.clearTimeout()})),o(this,"highlightCurrentCaption",(function(){l.removeCurrentHighlight();var e,n,o,i=l.player.getCurrentTime();l.currentCaption=l.captions.find((function(t){return t.start<=i&&t.end>i})),l.currentCaption&&(t(l.currentCaption.domElement,"highlight",!0),n=(e=l.currentCaption.domElement).getBoundingClientRect(),o=e.parentElement.getBoundingClientRect(),n.top>=o.top&&n.bottom<=o.bottom||setTimeout((function(){var t=l.currentCaption.domElement.offsetTop;l.captionBox.scrollTop=t}),0)),l.waitForNextCaption()})),o(this,"waitForNextCaption",(function(){l.clearTimeout();var t=l.player.getCurrentTime(),e=l.captions.find((function(e){return e.start>t}));if(e){var n=e.start-t;l.captionTimeout=setTimeout(l.highlightCurrentCaption,1e3*n)}})),o(this,"clearTimeout",(function(){l.captionTimeout&&clearTimeout(l.captionTimeout),l.captionTimeout=null})),o(this,"generateContainer",(function(){l.container=document.createElement("div"),l.container.className="ytdt",l.toggler=document.createElement("button"),l.toggler.className="toggle closed",l.toggler.addEventListener("click",l.toggle),l.toggler.textContent=i,l.container.append(l.toggler),l.captionBox=document.createElement("div"),l.captionBox.className="captions closed",l.container.append(l.captionBox)})),o(this,"insertAfterVideoFrame",(function(t){try{document.getElementById(l.videoID).after(t)}catch(t){throw t instanceof TypeError?new ReferenceError("Couldn't insert caption container by player ID."):t}})),o(this,"toggle",(function(){t(l.toggler,"closed"),t(l.toggler,"open"),t(l.captionBox,"closed"),t(l.captionBox,"open"),l.toggler.className.indexOf("closed")>-1?l.toggler.textContent=i:l.toggler.textContent="Close Transcript"})),o(this,"removeCurrentHighlight",(function(){l.currentCaption&&(t(l.currentCaption.domElement,"highlight",!1),l.currentCaption=null)})),this.videoID=r,!this.playerElement)throw new ReferenceError("Couldn't locate video embed frame.");var u="https://video.google.com/timedtext?v="+r;a&&(u+="&lang=".concat(a)),c&&(u+="&name=".concat(c)),this.generateContainer(),s?s(this.container):this.insertAfterVideoFrame(this.container),this.loadCaptions(u),this.player=new YT.Player(r,{videoId:r,events:{onStateChange:this.onStateChange}})};function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var c=[],s=[],l={Transcript:r,init:function(t,e,n,o){window.YT&&window.YT.Player?s.push(new r(t,e,n,o)):c.push([t,e,n,o])}},u=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){u&&u();var t,e=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,r=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw r}}}}(c);try{for(e.s();!(t=e.n()).done;){var n=t.value;l.init.apply(this,n)}}catch(t){e.e(t)}finally{e.f()}},window.ytdt?console.warn("Namespace already exists; not registering youtube-dynamic-transcripts"):window.ytdt=l}(),t.p}();
//# sourceMappingURL=youtube-dynamic-transcripts.min.js.map