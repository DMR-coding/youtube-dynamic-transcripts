!function(){"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var n;t.g.importScripts&&(n=t.g.location+"");var e=t.g.document;if(!n&&e&&(e.currentScript&&(n=e.currentScript.src),!n)){var o=e.getElementsByTagName("script");o.length&&(n=o[o.length-1].src)}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=n}(),function(){function t(t,n,e){var o=t.className.indexOf(n)>=0,r=null==e?!o:e;o&&r||!o&&!r||(r?t.className+=" ".concat(n):t.className=function(t,n,e){return t.split(" ").filter((function(t){return t!==n})).join(" ")}(t.className,n))}function n(t){if(null==t)throw new TypeError("Value may not be null.");return t}function e(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var o=function t(n,o,r){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),e(this,"domElement",void 0),e(this,"start",void 0),e(this,"end",void 0),this.end=o,this.start=n,this.domElement=document.createElement("a"),this.domElement.innerHTML=r,this.domElement.className="caption"};function r(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var i="Open Transcript",a=function e(a,c,u,l,s){var p=this;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"player",void 0),r(this,"captionTimeout",null),r(this,"currentCaption",null),r(this,"captions",[]),r(this,"videoID",void 0),r(this,"captionBox",void 0),r(this,"toggler",void 0),r(this,"container",void 0),r(this,"loadCaptions",(function(t){(function(t){return new Promise((function(n,e){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="document",o.onload=function(){n(o.response)},o.onerror=function(){e(o.status)},o.send()}))})(t).then(p.captionsLoaded).catch(p.captionsFailed),p.captionBox.textContent="Loading transcript..."})),r(this,"captionsLoaded",(function(t){var e=t.getElementsByTagName("text");p.captionBox.textContent="";for(var r=function(t){var r=e[t];try{var i=+n(r.getAttribute("start")),a=+n(r.getAttribute("dur"))+i,c=new o(i,a,n(r.textContent));c.domElement.addEventListener("click",(function(){p.seekToIndex(t)})),p.captions.push(c),p.captionBox.append(c.domElement)}catch(t){var u;t instanceof TypeError&&(null===(u=window.console)||void 0===u||u.warn("Found bad caption",r))}},i=0;i<e.length;i+=1)r(i);p.captionBox.scrollTop=0})),r(this,"seekToIndex",(function(t){var n=p.captions[t];p.player.seekTo(n.start,!0)})),r(this,"captionsFailed",(function(){p.captionBox.textContent="⚠️ Could not load transcript."})),r(this,"onStateChange",(function(t){t.data===YT.PlayerState.PLAYING?p.started():p.stopped()})),r(this,"started",(function(){p.highlightCurrentCaption()})),r(this,"stopped",(function(){p.removeCurrentHighlight(),p.clearTimeout()})),r(this,"highlightCurrentCaption",(function(){p.removeCurrentHighlight();var n=p.player.getCurrentTime();p.currentCaption=p.captions.find((function(t){return t.start<=n&&t.end>n})),p.currentCaption&&(t(p.currentCaption.domElement,"highlight",!0),p.ensureCurrentCaptionVisible()),p.waitForNextCaption()})),r(this,"ensureCurrentCaptionVisible",(function(){var t,e,o;p.currentCaption&&(e=(t=p.currentCaption.domElement).getBoundingClientRect(),o=n(t.parentElement).getBoundingClientRect(),e.top>=o.top&&e.bottom<=o.bottom||setTimeout((function(){if(p.currentCaption){var t=p.captionBox.firstElementChild.offsetTop;p.captionBox.scrollTop=p.currentCaption.domElement.offsetTop-t}}),0))})),r(this,"waitForNextCaption",(function(){p.clearTimeout();var t=p.player.getCurrentTime(),n=p.captions.find((function(n){return n.start>t}));if(n){var e=n.start-t;p.captionTimeout=setTimeout(p.highlightCurrentCaption,1e3*e)}})),r(this,"clearTimeout",(function(){p.captionTimeout&&clearTimeout(p.captionTimeout),p.captionTimeout=null})),r(this,"generateContainer",(function(){p.container=document.createElement("div"),p.container.className="ytdt",p.toggler=document.createElement("button"),p.toggler.className="toggle closed",p.toggler.addEventListener("click",p.toggle),p.toggler.textContent=i,p.container.append(p.toggler),p.captionBox=document.createElement("div"),p.captionBox.className="captions closed",p.container.append(p.captionBox)})),r(this,"insertAfterVideoFrame",(function(t){try{n(document.getElementById(p.videoID)).after(t)}catch(t){throw t instanceof TypeError?new ReferenceError("Couldn't insert caption container by player ID."):t}})),r(this,"toggle",(function(){t(p.toggler,"closed"),t(p.toggler,"open"),t(p.captionBox,"closed"),t(p.captionBox,"open"),p.toggler.className.indexOf("closed")>-1?p.toggler.textContent=i:p.toggler.textContent="Close Transcript"})),r(this,"removeCurrentHighlight",(function(){p.currentCaption&&(t(p.currentCaption.domElement,"highlight",!1),p.currentCaption=null)})),this.videoID=a;var f="https://video.google.com/timedtext?v="+a;c&&(f+="&lang=".concat(c)),u&&(f+="&name=".concat(u)),this.generateContainer(),s?s(this.container):this.insertAfterVideoFrame(this.container),this.loadCaptions(f),this.player=new YT.Player(l||a,{videoId:a,events:{onStateChange:this.onStateChange}})};function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function u(t,n,e){return(u=l()?Reflect.construct:function(t,n,e){var o=[null];o.push.apply(o,n);var r=new(Function.bind.apply(t,o));return e&&s(r,e.prototype),r}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function s(t,n){return(s=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}var p=[],f=[],d={Transcript:a,init:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];window.YT&&window.YT.Player?f.push(u(a,n)):p.push(n)}},h=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){h&&h();var t,n=function(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}(p);try{for(n.s();!(t=n.n()).done;){var e=t.value;d.init.apply(this,e)}}catch(t){n.e(t)}finally{n.f()}},window.ytdt?console.warn("Namespace already exists; not registering youtube-dynamic-transcripts"):window.ytdt=d}(),t.p}();
//# sourceMappingURL=youtube-dynamic-transcripts.min.js.map